groups:
  - id: registry.rpc
    type: attribute_group
    display_name: Remote Procedure Call (RPC) Attributes
    brief: 'This document defines attributes for remote procedure calls.'
    attributes:
      - id: rpc.response.status_code
        type: string
        stability: development
        brief: Status code of the RPC returned by the RPC server or generated by the client
        note: >
          Usually it represents an error code, but may also represent partial success,
          warning, or differentiate between various types of successful outcomes.

          Semantic conventions for individual RPC frameworks SHOULD document what
          `rpc.response.status_code` means in the context of that system and which values
          are considered to represent errors.
        examples: ["OK", "DEADLINE_EXCEEDED", "-32602"]
      - id: rpc.request.metadata
        type: template[string[]]
        stability: development
        brief: >
          RPC request metadata, `<key>` being the normalized RPC metadata key (lowercase), the value being the metadata values.
        note: |
          Instrumentations SHOULD require an explicit configuration of which metadata values are to be captured.
          Including all request metadata values can be a security risk - explicit configuration helps avoid leaking sensitive information.

          For example, a property `my-custom-key` with value `["1.2.3.4", "1.2.3.5"]` SHOULD be recorded as
          `rpc.request.metadata.my-custom-key` attribute with value `["1.2.3.4", "1.2.3.5"]`
        examples: [["1.2.3.4", "1.2.3.5"]]
      - id: rpc.response.metadata
        type: template[string[]]
        stability: development
        brief: >
          RPC response metadata, `<key>` being the normalized RPC metadata key (lowercase), the value being the metadata values.
        note: |
          Instrumentations SHOULD require an explicit configuration of which metadata values are to be captured.
          Including all response metadata values can be a security risk - explicit configuration helps avoid leaking sensitive information.

          For example, a property `my-custom-key` with value `["attribute_value"]` SHOULD be recorded as
          the `rpc.response.metadata.my-custom-key` attribute with value `["attribute_value"]`
        examples: [["attribute_value"]]
      - id: rpc.method
        type: string
        stability: development
        brief: The fully-qualified logical name of the method from the RPC
          interface perspective.
        examples:
          - "com.example.ExampleService/exampleMethod"
          - "EchoService/Echo"
          - "_OTHER"
        note: |
          The method name MAY have unbounded cardinality in edge or error cases.

          Some RPC frameworks or libraries provide a fixed set of recognized methods
          for client stubs and server implementations. Instrumentations for such
          frameworks MUST set this attribute to the original method name only
          when the method is recognized by the framework or library.

          When the method is not recognized, for example, when the server receives
          a request for a method that is not predefined on the server, or when
          instrumentation is not able to reliably detect if the method is predefined,
          the attribute MUST be set to `_OTHER`. In such cases, tracing
          instrumentations MUST also set `rpc.method_original` attribute to
          the original method value.

          If the RPC instrumentation could end up converting valid RPC methods to
          `_OTHER`, then it SHOULD provide a way to configure the list of recognized
          RPC methods.

          The `rpc.method` can be different from the name of any implementing
          method/function.
          The `code.function.name` attribute may be used to record the fully-qualified
          method actually executing the call on the server side, or the
          RPC client stub method on the client side.
      - id: rpc.method_original
        type: string
        stability: development
        brief: >
          The original name of the method used by the client.
        examples:
          - "com.myservice.EchoService/catchAll"
          - "com.myservice.EchoService/unknownMethod"
          - "InvalidMethod"
      - id: rpc.system.name
        brief: 'The Remote Procedure Call (RPC) system.'
        note: >
          The client and server RPC systems may differ for the same RPC interaction.
          For example, a client may use Apache Dubbo or Connect RPC to communicate
          with a server that uses gRPC since both protocols provide compatibility
          with gRPC.
        type:
          members:
            - id: grpc
              value: 'grpc'
              brief: '[gRPC](https://grpc.io/)'
              stability: development
            - id: dubbo
              value: 'dubbo'
              brief: '[Apache Dubbo](https://dubbo.apache.org/)'
              stability: development
            - id: connectrpc
              value: 'connectrpc'
              brief: '[Connect RPC](https://connectrpc.com/)'
              stability: development
            - id: jsonrpc
              value: 'jsonrpc'
              brief: '[JSON-RPC](https://www.jsonrpc.org/)'
              stability: development
        stability: development
      - id: rpc.message.type
        type:
          members:
            - id: sent
              value: "SENT"
              stability: development
            - id: received
              value: "RECEIVED"
              stability: development
        stability: development
        brief: "Whether this is a received or sent message."
      - id: rpc.message.id
        type: int
        stability: development
        brief: "MUST be calculated as two different counters starting from `1` one for sent messages and one for received message."
        note: "This way we guarantee that the values will be consistent between different implementations."
      - id: rpc.message.compressed_size
        type: int
        stability: development
        brief: "Compressed size of the message in bytes."
      - id: rpc.message.uncompressed_size
        type: int
        stability: development
        brief: "Uncompressed size of the message in bytes."
