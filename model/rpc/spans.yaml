groups:
  - id: span.rpc.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.
    extends: rpc_service
    span_kind: client
    events: [rpc.message]
    attributes:
      - ref: rpc.system
        requirement_level: required

  - id: span.rpc.server
    type: span
    stability: development
    extends: rpc_service.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    events: [rpc.message]
    note: |
      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.
    attributes:
      - ref: rpc.system
        requirement_level: required

  - id: span.rpc.connect_rpc.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"connect_rpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.
    extends: rpc_service
    span_kind: client
    attributes:
      - ref: rpc.connect_rpc.error_code
        requirement_level:
          conditionally_required: if available.
      - ref: rpc.connect_rpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.connect_rpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.connect_rpc.server
    type: span
    stability: development
    extends: rpc_service.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"connect_rpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.
    attributes:
      - ref: rpc.connect_rpc.error_code
        requirement_level:
          conditionally_required: if available.
      - ref: rpc.connect_rpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.connect_rpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.grpc.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"grpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.

      **Span status** Should be set based on the grpc status code. A mapping is defined in the [grpc status](/docs/rpc/grpc.md#grpc-status) section.
    extends: rpc_service
    span_kind: client
    attributes:
      - ref: rpc.method
        requirement_level: required
      - ref: rpc.service
        requirement_level: required
      - ref: rpc.grpc.status_code
        requirement_level: required
      - ref: rpc.grpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.grpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.grpc.server
    type: span
    stability: development
    extends: rpc_service.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"grpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.

      **Span status** Should be set based on the grpc status code. A mapping is defined in the [grpc status](/docs/rpc/grpc.md#grpc-status) section.
    attributes:
      - ref: rpc.grpc.status_code
        requirement_level: required
      - ref: rpc.grpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.grpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.jsonrpc.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"jsonrpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.
    extends: rpc
    span_kind: client
    attributes:
      - ref: rpc.method
        requirement_level: required
      - ref: rpc.jsonrpc.version
        requirement_level:
          conditionally_required: If other than the default version (`1.0`)
      - ref: rpc.jsonrpc.request_id
        requirement_level: recommended
      - ref: rpc.jsonrpc.error_code
        requirement_level:
          conditionally_required: when available
      - ref: rpc.jsonrpc.error_message
        requirement_level: recommended

  - id: span.rpc.jsonrpc.server
    type: span
    stability: development
    extends: rpc.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"jsonrpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.
    attributes:
      - ref: rpc.method
        requirement_level: required
      - ref: rpc.jsonrpc.version
        requirement_level:
          conditionally_required: If other than the default version (`1.0`)
      - ref: rpc.jsonrpc.request_id
        requirement_level: recommended
      - ref: rpc.jsonrpc.error_code
        requirement_level:
          conditionally_required: when available
      - ref: rpc.jsonrpc.error_message
        requirement_level: recommended

  - id: event.rpc.message
    type: event
    stability: development
    name: rpc.message
    brief: Describes a message sent or received within the context of an RPC call.
    note: >
      In the lifetime of an RPC stream, an event for each message sent/received on
      client and server spans SHOULD be created. In case of unary calls only one sent
      and one received message will be recorded for both client and server spans.
    attributes:
      - ref: rpc.message.type
        requirement_level: recommended
      - ref: rpc.message.id
        requirement_level: recommended
      - ref: rpc.message.compressed_size
        requirement_level: recommended
      - ref: rpc.message.uncompressed_size
        requirement_level: recommended
