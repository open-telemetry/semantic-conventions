groups:
  - id: span.rpc.call.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      RPC client spans SHOULD cover the entire client-side lifecycle of an RPC,
      starting when the RPC is initiated and ending when the response is received
      or the RPC is terminated due to an error or cancellation.

      For streaming RPCs, the span covers the full lifetime of the request and/or
      response streams until they are closed or terminated.

      If a transient issue happened and was retried within this RPC, the corresponding
      span SHOULD cover the duration of the logical call with all retries.

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status.
    extends: rpc_service
    span_kind: client
    events: [rpc.message]
    attributes:
      - ref: rpc.system.name
        requirement_level: required

  - id: span.rpc.call.server
    type: span
    stability: development
    extends: rpc_service.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    events: [rpc.message]
    note: |
      RPC server spans SHOULD cover the entire server-side lifecycle of an RPC,
      starting when the request is received and ending when the response is sent
      or the RPC is terminated due to an error or cancellation.

      For streaming RPCs, the span SHOULD cover the full lifetime of the request
      and/or response streams until they are closed or terminated.

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status.
    attributes:
      - ref: rpc.system.name
        requirement_level: required

  - id: span.rpc.connect_rpc.call.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"connect_rpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status.
    extends: rpc_service
    span_kind: client
    attributes:
      - ref: rpc.response.status_code
        requirement_level:
          conditionally_required: if available.
        brief: The [error code](https://connectrpc.com//docs/protocol/#error-codes) of the Connect response.
        note: |
          All error codes except `OK` SHOULD be considered errors.
      - ref: rpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.connect_rpc.call.server
    type: span
    stability: development
    extends: rpc_service.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"connect_rpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status.
    attributes:
      - ref: rpc.response.status_code
        requirement_level:
          conditionally_required: if available.
        brief: The [error code](https://connectrpc.com/docs/protocol/#error-codes) of the Connect response.
        note: |
          The following error codes SHOULD be considered errors:

          - `unknown`
          - `deadline_exceeded`
          - `unimplemented`
          - `internal`
          - `unavailable`
          - `data_loss`
      - ref: rpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.grpc.call.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"grpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status. See also `rpc.response.status_code` attribute
      for the details on which values classify as errors.
    extends: rpc_service
    span_kind: client
    attributes:
      - ref: rpc.method
        requirement_level: required
      - ref: rpc.service
        requirement_level: required
      - ref: rpc.response.status_code
        requirement_level: required
        brief: >
          The string representation of the [status code](https://github.com/grpc/grpc/blob/v1.75.0/doc/statuscodes.md)
          returned by the server or generated by the client.
        note: |
          All status codes except `OK` SHOULD be considered errors.
      - ref: rpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.grpc.call.server
    type: span
    stability: development
    extends: rpc_service.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"grpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status. See also `rpc.response.status_code` attribute
      for the details on which values classify as errors.
    attributes:
      - ref: rpc.response.status_code
        requirement_level: required
        brief: >
          The string representation of the [status code](https://github.com/grpc/grpc/blob/v1.75.0/doc/statuscodes.md)
          returned by the server.
        note: |
          The following status codes SHOULD be considered errors:

          - `UNKNOWN`
          - `DEADLINE_EXCEEDED`
          - `UNIMPLEMENTED`
          - `INTERNAL`
          - `UNAVAILABLE`
          - `DATA_LOSS`

      - ref: rpc.request.metadata
        requirement_level: opt_in
      - ref: rpc.response.metadata
        requirement_level: opt_in

  - id: span.rpc.jsonrpc.call.client
    type: span
    stability: development
    brief: This span represents an outgoing Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"jsonrpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `CLIENT`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status. Responses that include
      an [`error` object](https://www.jsonrpc.org/specification#error_object)
      are considered errors.
    extends: rpc
    span_kind: client
    attributes:
      - ref: rpc.method
        requirement_level: required
      - ref: jsonrpc.protocol.version
        requirement_level:
          conditionally_required: If other than the default version (`1.0`)
      - ref: jsonrpc.request.id
        requirement_level: recommended
      - ref: rpc.response.status_code
        brief: >
          The [`error.code`](https://www.jsonrpc.org/specification#error_object)
          property of response if it is an error response recorded as a string.
        note:
          All JSON RPC error codes SHOULD be considered errors.
        requirement_level:
          conditionally_required: when available

  - id: span.rpc.jsonrpc.call.server
    type: span
    stability: development
    extends: rpc.server
    span_kind: server
    brief: This span represents an incoming Remote Procedure Call (RPC).
    note: |
      `rpc.system` MUST be set to `"jsonrpc"` and SHOULD be provided **at span creation time.**

      **Span name:** refer to the [Span Name](/docs/rpc/rpc-spans.md#span-name) section.

      **Span kind** MUST be `SERVER`.

      **Span status** Refer to the [Recording Errors](/docs/general/recording-errors.md)
      document for details on how to record span status. Responses that include
      an [`error` object](https://www.jsonrpc.org/specification#error_object)
      are considered errors.
    attributes:
      - ref: rpc.method
        requirement_level: required
      - ref: jsonrpc.protocol.version
        requirement_level:
          conditionally_required: If other than the default version (`1.0`)
      - ref: jsonrpc.request.id
        requirement_level: recommended
      - ref: rpc.response.status_code
        brief: >
          The [`error.code`](https://www.jsonrpc.org/specification#error_object) property of
          response recorded as a string.
        note:
          All JSON RPC error codes SHOULD be considered errors.
        requirement_level:
          conditionally_required: when available

  - id: event.rpc.message
    type: event
    stability: development
    name: rpc.message
    brief: Describes a message sent or received within the context of an RPC call.
    note: >
      In the lifetime of an RPC stream, an event for each message sent/received on
      client and server spans SHOULD be created. In case of unary calls only one sent
      and one received message will be recorded for both client and server spans.
    attributes:
      - ref: rpc.message.type
        requirement_level: recommended
      - ref: rpc.message.id
        requirement_level: recommended
      - ref: rpc.message.compressed_size
        requirement_level: recommended
      - ref: rpc.message.uncompressed_size
        requirement_level: recommended
