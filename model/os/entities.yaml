groups:
  - id: entity.os
    type: entity
    stability: development
    name: os
    brief: >
      The operating system (OS) environment on which the process represented by this resource is running.
    note: >
      In case of virtualized environments, this is the operating system as it is observed by
      the process, i.e., the virtualized guest rather than the underlying host.
    attributes:
      - ref: os.id
        note: On linux this is to be the id from the os.release file.
        requirement_level: required
      - ref: os.type
      - ref: os.description
        note: >
          SHOULD the value not be provided natively via the SDK the following system sources can be used:


          | OS | Fallback |

          | ------- | ------- |

          | Windows | Concatentation of `ProductName` & `DisplayVersion` from registry `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion` |

          | MacOS | - |

          | Linux | `PRETTY_NAME` from `/etc/os-release` or `/usr/lib/os-release` |
      - ref: os.family
        note: >
          SHOULD the value not be provided natively via the SDK the following system sources can be used:


          | OS | Fallback |

          | ------- | ------- |

          | Linux | `ID_LIKE` from `/etc/os-release` or `/usr/lib/os-release` |
      - ref: os.name
        note: >
          SHOULD the value not be provided natively via the SDK the following system sources can be used:


          | OS | Fallback |

          | ------- | ------- |

          | Windows | "Windows" |

          | MacOS | `ProductName` from `/System/Library/CoreServices/SystemVersion.plist` or `/System/Library/CoreServices/ServerVersion.plist` |

          | Linux | `NAME` from `/etc/os-release` or `/usr/lib/os-release` |
      - ref: os.version
        note: >
          SHOULD the value not be provided natively via the SDK the following system sources can be used:


          | OS | Fallback |

          | ------- | ------- |

          | Windows | `WinREVersion` from registry `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion` |

          | MacOS | `ProductVersion` from `/System/Library/CoreServices/SystemVersion.plist` or `/System/Library/CoreServices/ServerVersion.plist` |

          | Linux | `VERSION_ID` from `/etc/os-release` or `/usr/lib/os-release` |
      - ref: os.build_id
        note: >
          SHOULD the value not be provided natively via the SDK the following system sources can be used:


          | OS | Fallback |

          | ------- | ------- |

          | Windows | `CurrentBuildNumber` from registry `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion` |

          | MacOS | `ProductBuildVersion` from `/System/Library/CoreServices/SystemVersion.plist` or `/System/Library/CoreServices/ServerVersion.plist` |

          | Linux | `BUILD_ID` from `/etc/os-release` or `/usr/lib/os-release` |
      - ref: os.variant.id
        note: >
          SHOULD the value not be provided natively via the SDK the following system sources can be used:


          | OS | Fallback |

          | ------- | ------- |

          | Windows | `EditionID` from registry `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion` |

          | MacOS | - |

          | Linux | `VARIANT_ID` from `/etc/os-release` or `/usr/lib/os-release` |
      - ref: os.variant.name
        note: >
          SHOULD the value not be provided natively via the SDK the following system sources can be used:


          | OS | Fallback |

          | ------- | ------- |

          | MacOS | - |

          | Linux | `VARIANT` from `/etc/os-release` or `/usr/lib/os-release` |
