groups:
  - id: trace.mcp.common.attributes
    type: attribute_group
    extends: mcp.common.attributes
    brief: MCP common span attributes
    attributes:
      - ref: mcp.session.id
      - ref: mcp.resource.uri
        requirement_level:
          conditionally_required: When the client executes a request type that includes a resource URI parameter.
      - ref: mcp.request.id
        requirement_level:
          conditionally_required: When the client executes a request.
      - ref: mcp.request.argument
        requirement_level: opt_in

  - id: span.mcp.client
    type: span
    span_kind: client
    brief: This span describes the MCP call from the client side.
    note: |
      It's reported by the MCP client when it initiates the request
      or notification or by the MCP server when server initiates the operation.
      It covers the time to receive the response or ack from the peer.

      **Span name** SHOULD follow the format `{mcp.method.name} {target}`
      where target is the `{mcp.tool.name}`, `{mcp.prompt.name}` or `{mcp.resource.uri}`
      depending on the request or notification type.

      **Span status** SHOULD be set to `ERROR` using the same condition as the `error.type`
      attribute. The status description SHOULD match the `JSONRPCError.message`
      if the message is available.

      Refer to the [Recording Errors](/docs/general/recording-errors.md) document
      for more details.
    stability: development
    extends: trace.mcp.common.attributes
    attributes:
      - ref: server.address
      - ref: server.port
        requirement_level:
          recommended: When `server.address` is set

  - id: span.mcp.server
    type: span
    span_kind: server
    brief: This span describes the processing of the MCP request or notification
      initiated by the peer.
    note: |
      It's reported by the MCP server when client initiates the request
      (or notification) or by the MCP client when server initiates the operation.

      **Span name** SHOULD follow the format `{mcp.method.name} {target}`
      where target is the `{mcp.tool.name}`, `{mcp.prompt.name}` or `{mcp.resource.uri}`
      depending on the request or notification type.

      **Span status** SHOULD be set to `ERROR` using the same condition as the `error.type`
      attribute. The status description SHOULD match the `JSONRPCError.message`
      if the message is available.

      Refer to the [Recording Errors](/docs/general/recording-errors.md) document
      for more details.
    stability: development
    extends: trace.mcp.common.attributes
    attributes:
      - ref: client.address
        requirement_level: recommended
      - ref: client.port
        requirement_level:
          recommended: When `client.address` is set
