<!--- Hugo front matter used to generate the website version of this page:
linkTitle: Security
--->

# Semantic conventions for GenAI security operations

**Status**: [Development][DocumentStatus]

<!-- toc -->

- [Spans](#spans)
  - [Apply guardrail](#apply-guardrail)
- [Events](#events)
  - [Event: `gen_ai.security.finding`](#event-gen_aisecurityfinding)

<!-- tocstop -->

GenAI systems and agent frameworks commonly use security guardians (sometimes called guardrails) to
evaluate content and actions for risks such as prompt injection, sensitive information disclosure, or
policy violations.

These semantic conventions define:

- A span that represents a single guardian evaluation.
- An event that captures individual security findings emitted during that evaluation.

## Spans

### Apply guardrail

<!-- semconv span.gen_ai.apply_guardrail.internal -->
<!-- NOTE: THIS TEXT IS AUTOGENERATED. DO NOT EDIT BY HAND. -->
<!-- see templates/registry/markdown/snippet.md.j2 -->
<!-- prettier-ignore-start -->

**Status:** ![Development](https://img.shields.io/badge/-development-blue)

Describes a security guardian evaluation.

`gen_ai.operation.name` SHOULD be `apply_guardrail`.

**Span name** SHOULD be `apply_guardrail {gen_ai.guardian.name}`.
When `gen_ai.guardian.name` is not available, it SHOULD be `apply_guardrail {gen_ai.security.target.type}`.

Guardian spans SHOULD be children of the operation span they are protecting (for example,
`span.gen_ai.inference.client` or `span.gen_ai.execute_tool.internal`).

Multiple guardian spans MAY exist under a single operation span if multiple guardians are chained.

**Span kind** SHOULD be `INTERNAL`.

**Span status** SHOULD follow the [Recording Errors](/docs/general/recording-errors.md) document.

**Attributes:**

| Key | Stability | [Requirement Level](https://opentelemetry.io/docs/specs/semconv/general/attribute-requirement-level/) | Value Type | Description | Example Values |
| --- | --- | --- | --- | --- | --- |
| [`gen_ai.operation.name`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Required` | string | The name of the operation being performed. [1] | `chat`; `generate_content`; `text_completion` |
| [`gen_ai.security.decision.type`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Required` | string | The decision made by the security guardian. | `allow`; `deny`; `modify` |
| [`gen_ai.security.target.type`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Required` | string | The type of content or action the guardrail is applied to. [2] | `tool_call`; `llm_input`; `llm_output`; `tool_definition` |
| [`error.type`](/docs/registry/attributes/error.md) | ![Stable](https://img.shields.io/badge/-stable-lightgreen) | `Conditionally Required` if the operation ended in an error | string | Describes a class of error the operation ended with. [3] | `timeout`; `java.net.UnknownHostException`; `server_certificate_invalid`; `500` |
| [`gen_ai.agent.id`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` when applicable | string | The unique identifier of the GenAI agent. | `asst_5j66UpCpwteGg4YSxUnt7lPY` |
| [`gen_ai.conversation.id`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` when available | string | The unique identifier for a conversation (session, thread), used to store and correlate messages within this conversation. | `conv_5j66UpCpwteGg4YSxUnt7lPY` |
| [`gen_ai.guardian.id`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` if available | string | The unique identifier of the security guardian or guardrail. [4] | `guard_abc123`; `sgi5gkybzqak`; `content-filter-v2` |
| [`gen_ai.security.content.input.hash`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` if correlation is needed and available | string | Hash of the input content for forensic correlation. [5] | `sha256:a3f2b8c9...` |
| [`gen_ai.security.content.redacted`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` if `gen_ai.security.decision.type` is `modify` | boolean | Whether the content was redacted or modified by the guardian. | `true`; `false` |
| [`gen_ai.security.decision.reason`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` [6] | string | Human-readable explanation for the security decision. [7] | `PII detected in output, masked before delivery`; `Prompt injection attempt denied`; `Action exceeds agent permission scope` |
| [`gen_ai.security.policy.id`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` if a policy triggered the decision | string | Identifier of the policy that triggered the decision. | `policy_pii_v2`; `deny-topic-financial-advice`; `org-compliance-001` |
| [`gen_ai.security.target.id`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` if available | string | Identifier of the specific target the guardrail is applied to. [8] | `call_xyz789`; `tool-123`; `mem_abc456` |
| [`gen_ai.guardian.name`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string | Human-readable name of the guardian or guardrail. | `PII Protection`; `Prompt Injection Shield`; `Content Safety` |
| [`gen_ai.guardian.provider.name`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string | The provider or vendor of the guardian service. | `azure.ai.content_safety`; `zenity`; `custom` |
| [`gen_ai.guardian.version`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string | Version of the guardian configuration or policy. | `1.0.0`; `2024-05-01`; `v2` |
| [`gen_ai.security.decision.code`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | int | Numeric code for the security decision (provider-specific). | `112`; `403`; `5001` |
| [`gen_ai.security.policy.name`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string | Human-readable name of the triggered policy. | `PII Protection Policy`; `Financial Advice Restriction` |
| [`gen_ai.security.policy.version`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string | Version of the policy that triggered the decision. | `1.0`; `2024-05-01` |
| [`gen_ai.security.content.input.value`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Opt-In` | any | The input content that was evaluated by the guardian. [9] | `Send an email to customer@example.com` |
| [`gen_ai.security.content.output.value`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Opt-In` | any | The output content after guardian processing (if modified). [10] | `Send an email to [REDACTED]` |

**[1] `gen_ai.operation.name`:** If one of the predefined values applies, but specific system uses a different name it's RECOMMENDED to document it in the semantic conventions for specific GenAI system and use system-specific name in the instrumentation. If a different name is not documented, instrumentation libraries SHOULD use applicable predefined value.

**[2] `gen_ai.security.target.type`:** If one of the predefined values applies, the respective value MUST be used; otherwise, a custom value MAY be used.

**[3] `error.type`:** The `error.type` SHOULD match the error code returned by the guardian or the client library,
the canonical name of exception that occurred, or another low-cardinality error identifier.
Instrumentations SHOULD document the list of errors they report.

**[4] `gen_ai.guardian.id`:** This is a vendor-neutral identifier for the security component that evaluated content or an action. It may map to provider-specific IDs such as `azure.ai.content_safety.blocklist.id`.

**[5] `gen_ai.security.content.input.hash`:** Use when full content capture is not desired but correlation is needed. Instrumentations SHOULD document the algorithm and any salting/HMAC approach used.

**[6] `gen_ai.security.decision.reason`:** if `gen_ai.security.decision.type` is not `allow` and a reason is available

**[7] `gen_ai.security.decision.reason`:** The value SHOULD be low-cardinality and MUST NOT contain sensitive user content or other high-risk data.

**[8] `gen_ai.security.target.id`:** For example, a tool call identifier, request identifier, or memory entry identifier, if applicable.

**[9] `gen_ai.security.content.input.value`:**

> [!WARNING]
> This attribute may contain sensitive information including user/PII
> data. Instrumentations SHOULD NOT capture this by default. Enable via
> opt-in configuration only.

This attribute MAY be truncated. For correlation without full content,
consider `gen_ai.security.content.input.hash`.

**[10] `gen_ai.security.content.output.value`:**

> [!WARNING]
> This attribute may contain sensitive information. Instrumentations
> SHOULD NOT capture this by default. Enable via opt-in configuration
> only.

For `modify` decisions, this MAY contain the sanitized/redacted result.

---

`error.type` has the following list of well-known values. If one of them applies, then the respective value MUST be used; otherwise, a custom value MAY be used.

| Value | Description | Stability |
| --- | --- | --- |
| `_OTHER` | A fallback error value to be used when the instrumentation doesn't define a custom value. | ![Stable](https://img.shields.io/badge/-stable-lightgreen) |

---

`gen_ai.operation.name` has the following list of well-known values. If one of them applies, then the respective value MUST be used; otherwise, a custom value MAY be used.

| Value | Description | Stability |
| --- | --- | --- |
| `apply_guardrail` | Apply a security guardrail to content or an action | ![Development](https://img.shields.io/badge/-development-blue) |
| `chat` | Chat completion operation such as [OpenAI Chat API](https://platform.openai.com/docs/api-reference/chat) | ![Development](https://img.shields.io/badge/-development-blue) |
| `create_agent` | Create GenAI agent | ![Development](https://img.shields.io/badge/-development-blue) |
| `embeddings` | Embeddings operation such as [OpenAI Create embeddings API](https://platform.openai.com/docs/api-reference/embeddings/create) | ![Development](https://img.shields.io/badge/-development-blue) |
| `execute_tool` | Execute a tool | ![Development](https://img.shields.io/badge/-development-blue) |
| `generate_content` | Multimodal content generation operation such as [Gemini Generate Content](https://ai.google.dev/api/generate-content) | ![Development](https://img.shields.io/badge/-development-blue) |
| `invoke_agent` | Invoke GenAI agent | ![Development](https://img.shields.io/badge/-development-blue) |
| `retrieval` | Retrieval operation such as [OpenAI Search Vector Store API](https://platform.openai.com/docs/api-reference/vector-stores/search) | ![Development](https://img.shields.io/badge/-development-blue) |
| `text_completion` | Text completions operation such as [OpenAI Completions API (Legacy)](https://platform.openai.com/docs/api-reference/completions) | ![Development](https://img.shields.io/badge/-development-blue) |

---

`gen_ai.security.decision.type` has the following list of well-known values. If one of them applies, then the respective value MUST be used; otherwise, a custom value MAY be used.

| Value | Description | Stability |
| --- | --- | --- |
| `allow` | Request permitted to proceed without modification. | ![Development](https://img.shields.io/badge/-development-blue) |
| `audit` | Request logged for audit purposes only, no enforcement. | ![Development](https://img.shields.io/badge/-development-blue) |
| `deny` | Request denied and operation halted. | ![Development](https://img.shields.io/badge/-development-blue) |
| `modify` | Request permitted with modifications (redaction, sanitization). | ![Development](https://img.shields.io/badge/-development-blue) |
| `warn` | Request permitted but flagged for review. | ![Development](https://img.shields.io/badge/-development-blue) |

---

`gen_ai.security.target.type` has the following list of well-known values. If one of them applies, then the respective value MUST be used; otherwise, a custom value MAY be used.

| Value | Description | Stability |
| --- | --- | --- |
| `knowledge_query` | Knowledge/RAG query being sent. | ![Development](https://img.shields.io/badge/-development-blue) |
| `knowledge_result` | Knowledge/RAG results being returned. | ![Development](https://img.shields.io/badge/-development-blue) |
| `llm_input` | Prompt or messages being sent to the model. | ![Development](https://img.shields.io/badge/-development-blue) |
| `llm_output` | Response or messages returned from the model. | ![Development](https://img.shields.io/badge/-development-blue) |
| `memory_retrieve` | Data being read from memory. | ![Development](https://img.shields.io/badge/-development-blue) |
| `memory_store` | Data being written to memory. | ![Development](https://img.shields.io/badge/-development-blue) |
| `message` | Conversation message (user, assistant, tool). | ![Development](https://img.shields.io/badge/-development-blue) |
| `tool_call` | Tool execution request (tool call invocation). | ![Development](https://img.shields.io/badge/-development-blue) |
| `tool_definition` | Tool definition or schema (tool declaration). | ![Development](https://img.shields.io/badge/-development-blue) |

<!-- prettier-ignore-end -->
<!-- END AUTOGENERATED TEXT -->
<!-- endsemconv -->

## Events

### Event: `gen_ai.security.finding`

<!-- semconv event.gen_ai.security.finding -->
<!-- NOTE: THIS TEXT IS AUTOGENERATED. DO NOT EDIT BY HAND. -->
<!-- see templates/registry/markdown/snippet.md.j2 -->
<!-- prettier-ignore-start -->

**Status:** ![Development](https://img.shields.io/badge/-development-blue)

The event name MUST be `gen_ai.security.finding`.

Reports a specific security finding detected during guardian evaluation.

Multiple findings MAY be emitted for a single guardian span.

Events SHOULD be parented to the `span.gen_ai.apply_guardrail.internal` span when possible.

**Attributes:**

| Key | Stability | [Requirement Level](https://opentelemetry.io/docs/specs/semconv/general/attribute-requirement-level/) | Value Type | Description | Example Values |
| --- | --- | --- | --- | --- | --- |
| [`gen_ai.security.risk.category`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Required` | string | The category of security risk detected. [1] | `prompt_injection`; `sensitive_info_disclosure`; `jailbreak`; `custom:financial_advice_violation`; `azure:hate_speech` |
| [`gen_ai.security.risk.severity`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Required` | string | The severity level of the detected risk. | `low`; `medium`; `high`; `critical` |
| [`gen_ai.security.policy.id`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Conditionally Required` if triggered by a specific policy | string | Identifier of the policy that triggered the decision. | `policy_pii_v2`; `deny-topic-financial-advice`; `org-compliance-001` |
| [`gen_ai.security.policy.name`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string | Human-readable name of the triggered policy. | `PII Protection Policy`; `Financial Advice Restriction` |
| [`gen_ai.security.policy.version`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string | Version of the policy that triggered the decision. | `1.0`; `2024-05-01` |
| [`gen_ai.security.risk.metadata`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | string[] | Non-content metadata about the detected risk. [2] | `["field:bcc", "pattern:email"]`; `["count:2", "position:output.content"]` |
| [`gen_ai.security.risk.score`](/docs/registry/attributes/gen-ai.md) | ![Development](https://img.shields.io/badge/-development-blue) | `Recommended` | double | Numeric risk/confidence score (0.0 to 1.0). | `0.85`; `0.95`; `0.42` |

**[1] `gen_ai.security.risk.category`:** This attribute is free-form to accommodate provider-specific,
organization-specific, or emerging risk categories.

Suggested values aligned with OWASP LLM Top 10 2025 include:
- `prompt_injection` (LLM01)
- `sensitive_info_disclosure` (LLM02)
- `supply_chain` (LLM03)
- `data_and_model_poisoning` (LLM04)
- `improper_output_handling` (LLM05)
- `excessive_agency` (LLM06)
- `system_prompt_leakage` (LLM07)
- `vector_and_embedding_weaknesses` (LLM08)
- `misinformation` (LLM09)
- `unbounded_consumption` (LLM10)

Instrumentations MAY use additional values when appropriate, for
example: `jailbreak`, `toxicity`, `pii`, `custom:*`, `azure:*`.

**[2] `gen_ai.security.risk.metadata`:**

> [!WARNING]
> This attribute MUST NOT contain sensitive user content, PII, or other
> high-risk data.

Example values include:
- Field identifiers: `field:bcc`, `parameter:query`
- Pattern types: `pattern:ssn`, `pattern:credit_card`
- Counts: `count:3`
- Positions: `position:input[0].content`

---

`gen_ai.security.risk.severity` has the following list of well-known values. If one of them applies, then the respective value MUST be used; otherwise, a custom value MAY be used.

| Value | Description | Stability |
| --- | --- | --- |
| `critical` | Critical severity risk requiring immediate action. | ![Development](https://img.shields.io/badge/-development-blue) |
| `high` | High severity risk. | ![Development](https://img.shields.io/badge/-development-blue) |
| `low` | Low severity risk. | ![Development](https://img.shields.io/badge/-development-blue) |
| `medium` | Medium severity risk. | ![Development](https://img.shields.io/badge/-development-blue) |
| `none` | No risk detected. | ![Development](https://img.shields.io/badge/-development-blue) |

<!-- prettier-ignore-end -->
<!-- END AUTOGENERATED TEXT -->
<!-- endsemconv -->

[DocumentStatus]: https://opentelemetry.io/docs/specs/otel/document-status

